<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>{% block title %}{% endblock %} NonRel Blog</title>
        <link rel="stylesheet" type="text/css" href="/static/bootstrap/css/bootstrap.min.css" />
        <link rel="stylesheet" type="text/css" href="/static/nonrel-blog.css" />
    </head>
    <body>
        <header>
        <div class="navbar navbar-inverse navbar-fixed-top">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="/">NonRel Blog</a>
            </div>
            <div class="collapse navbar-collapse">
              <ul class="nav navbar-nav">
                  {% if not user.is_authenticated %}
                  <li><a href="/login">Login</a></li>
                  <li><a href="/register">Register</a></li>
                  {% else %}
                  <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">{{ user.username }} <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                      <li><a href="/create_post">Create new post</a></li>
                      <li><a href="/logout">Logout</a></li>
                    </ul>
                  {% endif %}
              </ul>
            <form class="navbar-form navbar-right" action="/search/" method="get">
            <div class="form-group">
                <input type="text" placeholder="Search..." name="q" class="form-control" />
            </div>
            <span class="glyphicon glyphicon-search"></span>
            </form>
            </div><!--/.nav-collapse -->
          </div>
        </div>
        </header>
        <div id="main" class="starter-template">
        {% block content %}{% endblock %}
        </div>
        <!-- end main div -->
        <script id="postListTemplate" type="text/template">
            <h2><a href="#post/<%- id %>"><%- title %></a></h2>
            <p><small><strong><%= created_on_readable %></strong></small></p>
            <ul>
            <% _.each(tags.listItems, function(listItem) { %>
            <a href="/tag/<%- tag %>"><button type="button" class="btn btn-default btn-xs">{{ tag }}</button></a>
            <% }); %>
            </ul>
            <p><% print(text.substring(0,250)); %>...</p>
            <p class="right-italic"><% print(comments.length); %> comments</p>
        </script>
        <script id="postTemplate" type="text/template">
            <h1><%= title %></h1>
            <p class="date">Posted on <%= created_on_readable %></p>
            <% if (tags.length > 0) { %>
                <ul>
                <% _.each(tags.listItems, function(listItem) { %>
                <a href="/tag/<%- tag %>"><button type="button" class="btn btn-default btn-xs">{{ tag }}</button></a>
                <% }); %>
                </ul>
            <% } %>
            <p><%- text %></p>
            <% if (comments.length > 0) { %>
            <div id="comment-section">
                <% _.each(comments.listItems, function(listItem) { %>
                <div class="comment">
                    <p><small><%- comment.text %></small></p>
                    <p class="text-right"><small>by <%- comment.author.name %> - <%- comment.author.email %></small></p>
                <% }); %>
                </div>
            <% }else{ %>
                <h3>No comments</h3>
            <% } %>
            </div>
        </script>
        <script id="loadMoreTemplate" type="text/template">
            <p class="text-center"><a id="load-more-posts" class="btn btn-primary">Load more posts...</a></p>
        </script>
        <script type="text/javascript" src="/static/js/lib/jquery-1.11.0.js"></script>
        <script type="text/javascript" src="/static/js/lib/underscore.js"></script>
        <script type="text/javascript" src="/static/js/lib/backbone.js"></script>
        <script type="text/javascript" src="/static/bootstrap/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="/static/js/routers/router.js"></script>
        <script type="text/javascript" src="/static/js/models/post.js"></script>
        <script type="text/javascript" src="/static/js/collections/blog.js"></script>
        <script type="text/javascript" src="/static/js/views/postList.js"></script>
        <script type="text/javascript" src="/static/js/views/post.js"></script>
        <script type="text/javascript" src="/static/js/views/blog.js"></script>
        {% block backbone_init %}{% endblock %}
    </body>
</html>